import{r as x,j as s,L as t,v as j,b as g,a as o}from"./app-C8shHsPf.js";import{A as N}from"./AppLayout-BLsdKGGp.js";import{u as v,F}from"./FormulaForm-DTLIOQ_f.js";import{I as C}from"./IconArrowLeft-DuPKu4fQ.js";import"./IconRefresh-D4MBDMrg.js";import"./IconAlertCircle-DQAoqimh.js";import"./IconMath-fwBtLO5o.js";import"./card-f9el_SxJ.js";import"./IconCircleCheck-e_U_QFeQ.js";import"./apiClient-B5VLjQ69.js";import"./IconPlayerPlay-DFBbOW6V.js";import"./IconCopy-BAJLzt9p.js";import"./IconDownload-Bbm4F2cX.js";import"./IconChevronUp-CAfByx67.js";function D({products:n,returnTypes:c,supportedOperations:m,fieldSuggestions:d,functionDocumentation:u}){const[f,r]=x.useState(!1),{handleSuccess:h,handleError:l}=v(),p=async a=>{if(r(!0),console.log("Submitting formula data:",a),!j()){console.error("CSRF token not available for formula submission"),l("CSRF token not available. Please refresh the page."),r(!1);return}const i=g();i&&(a._token=i);try{await o.post("/formulas",a,{onStart:()=>{console.log("Formula form submission started...")},onProgress:()=>{console.log("Formula form submission in progress...")},onSuccess:e=>{console.log("Formula form submission successful:",e),h("Formula created successfully!"),o.get("/formulas")},onError:e=>{console.error("Formula form submission error:",e),l(e,{fallbackMessage:"Failed to create formula. Please check your inputs and try again."})},onFinish:()=>{console.log("Formula form submission finished"),r(!1)}})}catch(e){console.error("Formula submit error:",e),r(!1)}},b=()=>{o.get("/formulas")};return s.jsxs(N,{title:"Create Formula",children:[s.jsx("div",{className:"page-header d-print-none",children:s.jsx("div",{className:"container-xl",children:s.jsxs("div",{className:"row g-2 align-items-center",children:[s.jsxs("div",{className:"col",children:[s.jsx("nav",{"aria-label":"breadcrumb",children:s.jsxs("ol",{className:"breadcrumb",children:[s.jsx("li",{className:"breadcrumb-item",children:s.jsx(t,{href:"/formulas",children:"Formulas"})}),s.jsx("li",{className:"breadcrumb-item active","aria-current":"page",children:"Create"})]})}),s.jsx("div",{className:"page-pretitle",children:"Analytics"}),s.jsx("h2",{className:"page-title",children:"Create Formula"})]}),s.jsx("div",{className:"col-auto ms-auto d-print-none",children:s.jsx("div",{className:"btn-list",children:s.jsxs(t,{href:"/formulas",className:"btn",children:[s.jsx(C,{size:16,className:"me-1"}),"Back to Formulas"]})})})]})})}),s.jsx("div",{className:"page-body",children:s.jsx("div",{className:"container-fluid px-3",children:s.jsx("div",{className:"row g-3",children:s.jsx("div",{className:"col-12",children:s.jsxs("div",{className:"card",children:[s.jsx("div",{className:"card-header",children:s.jsx("h3",{className:"card-title",children:"Formula Details"})}),s.jsx("div",{className:"card-body",children:s.jsx(F,{onSubmit:p,onCancel:b,products:n,returnTypes:c,supportedOperations:m,fieldSuggestions:d,functionDocumentation:u,isSubmitting:f,submitLabel:"Create Formula"})})]})})})})})]})}export{D as default};
