import{u as v,r,j as e,H as E,L as n}from"./app-C8shHsPf.js";import{A as D,c as h}from"./AppLayout-BLsdKGGp.js";import{D as S}from"./DashboardBuilder-DoyZuVKc.js";import{D as C,E as A}from"./ExportModal-BmmLasmb.js";import{I}from"./IconArrowLeft-DuPKu4fQ.js";import{I as L}from"./IconDownload-Bbm4F2cX.js";import"./HeatmapWidget-z64eCmYe.js";import"./useCurrency-BrVL6EtE.js";import"./IconTrendingDown-DxWaTkIF.js";import"./IconTrendingUp-BvKv0kIF.js";import"./IconSearch-DIp72qHC.js";import"./IconChevronUp-CAfByx67.js";import"./PieChart-B7pCy4W1.js";import"./IconTrash-Cz_CNdIA.js";import"./IconChartPie-C5cc7RkP.js";import"./IconDeviceFloppy-VeGpiHi0.js";import"./IconPlus-CXVMLQlR.js";import"./IconFilter-D_cHaaz4.js";import"./IconRefresh-D4MBDMrg.js";import"./IconCalendar-BPxyuryE.js";import"./IconCurrencyDollar-e0qkPEsc.js";import"./IconAlertCircle-DQAoqimh.js";function ee(){var m;const{dashboard:s}=v().props,[o,d]=r.useState({}),[x,f]=r.useState({}),[u,l]=r.useState(!1),[g,c]=r.useState(!1),[j,b]=r.useState({});r.useEffect(()=>{N()},[]);const N=async()=>{var i;try{const t=await fetch(`/api/dashboards/${s.id}/filter-options`,{headers:{"X-CSRF-TOKEN":(i=document.querySelector('meta[name="csrf-token"]'))==null?void 0:i.getAttribute("content"),Accept:"application/json","Content-Type":"application/json"},credentials:"same-origin"});if(t.ok){const a=await t.json();f(a.data||{})}else console.error("Failed to fetch filter options:",t.status,t.statusText)}catch(t){console.error("Failed to fetch filter options:",t)}},y=i=>{d(i)},w=async i=>{var t;l(!0);try{const a=await fetch(`/api/dashboards/${s.id}/filters`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":(t=document.querySelector('meta[name="csrf-token"]'))==null?void 0:t.getAttribute("content"),Accept:"application/json"},credentials:"same-origin",body:JSON.stringify({filters:i})});if(a.ok){const p=await a.json();b(p.data||{}),d(p.applied_filters||i)}else console.error("Failed to apply filters:",a.status,a.statusText)}catch(a){console.error("Error applying filters:",a)}finally{l(!1)}},F=()=>{c(!0)};return e.jsxs(D,{children:[e.jsx(E,{title:`Dashboard - ${s.name}`}),e.jsxs("div",{className:"page-wrapper",children:[e.jsx("div",{className:"page-header d-print-none",children:e.jsx("div",{className:"container-xl",children:e.jsxs("div",{className:"row g-2 align-items-center",children:[e.jsxs("div",{className:"col",children:[e.jsx("div",{className:"page-pretitle",children:e.jsxs(n,{href:"/dashboards",className:"text-muted",children:[e.jsx(I,{size:16,className:"me-1"}),"Back to Dashboards"]})}),e.jsx("h2",{className:"page-title",children:s.name}),e.jsxs("div",{className:"text-muted mt-1",children:[((m=s.widgets)==null?void 0:m.length)||0," widgets â€¢ Created ",new Date(s.created_at).toLocaleDateString()]})]}),e.jsx("div",{className:"col-auto ms-auto d-print-none",children:e.jsxs("div",{className:"btn-list",children:[e.jsxs("button",{type:"button",className:"btn btn-outline-primary",onClick:F,children:[e.jsx(L,{size:16,className:"me-1"}),"Export"]}),e.jsxs(n,{href:`/dashboards/${s.id}/edit`,className:"btn btn-primary",children:[e.jsx(h,{size:16,className:"me-1"}),"Edit Dashboard"]})]})})]})})}),e.jsx("div",{className:"page-body",children:e.jsx("div",{className:"container-xl",children:s.widgets&&s.widgets.length>0?e.jsxs(e.Fragment,{children:[e.jsx(C,{filters:o,onFiltersChange:y,onApplyFilters:w,filterOptions:x,isLoading:u,className:"mb-4"}),e.jsx(S,{widgets:s.widgets,onWidgetsChange:()=>{},isEditing:!1,dashboardId:s.id,filteredData:j,appliedFilters:o})]}):e.jsxs("div",{className:"empty",children:[e.jsx("div",{className:"empty-img",children:e.jsx("img",{src:"/static/illustrations/undraw_printing_invoices_5r4r.svg",height:"128",alt:""})}),e.jsx("p",{className:"empty-title",children:"No widgets in this dashboard"}),e.jsx("p",{className:"empty-subtitle text-muted",children:"This dashboard doesn't have any widgets yet. Edit the dashboard to add some visualizations."}),e.jsx("div",{className:"empty-action",children:e.jsxs(n,{href:`/dashboards/${s.id}/edit`,className:"btn btn-primary",children:[e.jsx(h,{size:16,className:"me-1"}),"Edit Dashboard"]})})]})})}),e.jsx(A,{isOpen:g,onClose:()=>c(!1),dashboardId:s.id,dashboardName:s.name,currentFilters:o})]})]})}export{ee as default};
