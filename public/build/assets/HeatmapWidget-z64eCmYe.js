import{h as q,g as Ve}from"./AppLayout-BLsdKGGp.js";import{r as i,c as Ke,j as t,L as de}from"./app-C8shHsPf.js";import{u as Be}from"./useCurrency-BrVL6EtE.js";import{I as Ue}from"./IconTrendingDown-DxWaTkIF.js";import{I as He}from"./IconTrendingUp-BvKv0kIF.js";import{I as qe}from"./IconSearch-DIp72qHC.js";import{I as Ge,a as Xe}from"./IconChevronUp-CAfByx67.js";import{aj as Ze,c as te,D as Ye,ak as Je,u as Ne,al as Qe,am as et,an as tt,ao as at,ap as rt,aq as nt,ar as st,z as we,as as it,at as ue,au as lt,a as ae,e as Se,av as Pe,aw as Ae,ax as ot,ay as ct,Q as dt,R as he,a6 as ke,I as Ee,S as ut,az as ht,W as mt,aA as ft,a5 as pt,X as De,aB as xt,aC as vt,aD as gt,f as re,aE as Ce,L as Le,aF as yt,aG as jt,Y as bt,Z as Oe,aH as me,$ as fe,a0 as Nt,a1 as wt,a4 as H,a2 as St,a3 as Pt,aI as At,v as kt,J as Et,aJ as Dt,a8 as Ct,a9 as ne,aa as Lt,ab as Ie,ac as $e,ad as _e,ae as se,af as pe,ag as Ot,ah as It,ai as $t}from"./PieChart-B7pCy4W1.js";/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const _t=[["path",{d:"M12 6h-6a2 2 0 0 0 -2 2v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-6",key:"svg-0"}],["path",{d:"M11 13l9 -9",key:"svg-1"}],["path",{d:"M15 4h5v5",key:"svg-2"}]],xe=q("outline","external-link","ExternalLink",_t);/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tt=[["path",{d:"M14 3v4a1 1 0 0 0 1 1h4",key:"svg-0"}],["path",{d:"M17 21h-10a2 2 0 0 1 -2 -2v-14a2 2 0 0 1 2 -2h7l5 5v11a2 2 0 0 1 -2 2z",key:"svg-1"}],["path",{d:"M8 11h8v7h-8z",key:"svg-2"}],["path",{d:"M8 15h8",key:"svg-3"}],["path",{d:"M11 11v7",key:"svg-4"}]],zt=q("outline","file-spreadsheet","FileSpreadsheet",Tt);/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ft=[["path",{d:"M5 12l14 0",key:"svg-0"}]],Wt=q("outline","minus","Minus",Ft);/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rt=[["path",{d:"M3 5a2 2 0 0 1 2 -2h14a2 2 0 0 1 2 2v14a2 2 0 0 1 -2 2h-14a2 2 0 0 1 -2 -2v-14z",key:"svg-0"}],["path",{d:"M3 10h18",key:"svg-1"}],["path",{d:"M10 3v18",key:"svg-2"}]],Ra=q("outline","table","Table",Rt);function J(){return J=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},J.apply(null,arguments)}function ve(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),n.push.apply(n,a)}return n}function Mt(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?ve(Object(n),!0).forEach(function(a){ie(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ve(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function ie(e,r,n){return(r=Vt(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function Vt(e){var r=Kt(e,"string");return typeof r=="symbol"?r:r+""}function Kt(e,r){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,r);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var $=32;class le extends i.PureComponent{renderIcon(r,n){var{inactiveColor:a}=this.props,s=$/2,h=$/6,d=$/3,f=r.inactive?a:r.color,p=n??r.type;if(p==="none")return null;if(p==="plainline")return i.createElement("line",{strokeWidth:4,fill:"none",stroke:f,strokeDasharray:r.payload.strokeDasharray,x1:0,y1:s,x2:$,y2:s,className:"recharts-legend-icon"});if(p==="line")return i.createElement("path",{strokeWidth:4,fill:"none",stroke:f,d:"M0,".concat(s,"h").concat(d,`
            A`).concat(h,",").concat(h,",0,1,1,").concat(2*d,",").concat(s,`
            H`).concat($,"M").concat(2*d,",").concat(s,`
            A`).concat(h,",").concat(h,",0,1,1,").concat(d,",").concat(s),className:"recharts-legend-icon"});if(p==="rect")return i.createElement("path",{stroke:"none",fill:f,d:"M0,".concat($/8,"h").concat($,"v").concat($*3/4,"h").concat(-$,"z"),className:"recharts-legend-icon"});if(i.isValidElement(r.legendIcon)){var v=Mt({},r);return delete v.legendIcon,i.cloneElement(r.legendIcon,v)}return i.createElement(Ze,{fill:f,cx:s,cy:s,size:$,sizeType:"diameter",type:p})}renderItems(){var{payload:r,iconSize:n,layout:a,formatter:s,inactiveColor:h,iconType:d}=this.props,f={x:0,y:0,width:$,height:$},p={display:a==="horizontal"?"inline-block":"block",marginRight:10},v={display:"inline-block",verticalAlign:"middle",marginRight:4};return r.map((x,g)=>{var P=x.formatter||s,w=te({"recharts-legend-item":!0,["legend-item-".concat(g)]:!0,inactive:x.inactive});if(x.type==="none")return null;var u=x.inactive?h:x.color,o=P?P(x.value,x,g):x.value;return i.createElement("li",J({className:w,style:p,key:"legend-item-".concat(g)},Ye(this.props,x,g)),i.createElement(Je,{width:n,height:n,viewBox:f,style:v,"aria-label":"".concat(o," legend icon")},this.renderIcon(x,d)),i.createElement("span",{className:"recharts-legend-item-text",style:{color:u}},o))})}render(){var{payload:r,layout:n,align:a}=this.props;if(!r||!r.length)return null;var s={padding:0,margin:0,textAlign:n==="horizontal"?a:"left"};return i.createElement("ul",{className:"recharts-default-legend",style:s},this.renderItems())}}ie(le,"displayName","Legend");ie(le,"defaultProps",{align:"center",iconSize:14,inactiveColor:"#ccc",layout:"horizontal",verticalAlign:"middle"});function Bt(){return Ne(Qe)}var Ut=["contextPayload"];function Q(){return Q=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},Q.apply(null,arguments)}function ge(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),n.push.apply(n,a)}return n}function V(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?ge(Object(n),!0).forEach(function(a){oe(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ge(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function oe(e,r,n){return(r=Ht(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function Ht(e){var r=qt(e,"string");return typeof r=="symbol"?r:r+""}function qt(e,r){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,r);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function Gt(e,r){if(e==null)return{};var n,a,s=Xt(e,r);if(Object.getOwnPropertySymbols){var h=Object.getOwnPropertySymbols(e);for(a=0;a<h.length;a++)n=h[a],r.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(s[n]=e[n])}return s}function Xt(e,r){if(e==null)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)!==-1)continue;n[a]=e[a]}return n}function Zt(e){return e.value}function Yt(e){var{contextPayload:r}=e,n=Gt(e,Ut),a=lt(r,e.payloadUniqBy,Zt),s=V(V({},n),{},{payload:a});return i.isValidElement(e.content)?i.cloneElement(e.content,s):typeof e.content=="function"?i.createElement(e.content,s):i.createElement(le,s)}function Jt(e,r,n,a,s,h){var{layout:d,align:f,verticalAlign:p}=r,v,x;return(!e||(e.left===void 0||e.left===null)&&(e.right===void 0||e.right===null))&&(f==="center"&&d==="vertical"?v={left:((a||0)-h.width)/2}:v=f==="right"?{right:n&&n.right||0}:{left:n&&n.left||0}),(!e||(e.top===void 0||e.top===null)&&(e.bottom===void 0||e.bottom===null))&&(p==="middle"?x={top:((s||0)-h.height)/2}:x=p==="bottom"?{bottom:n&&n.bottom||0}:{top:n&&n.top||0}),V(V({},v),x)}function Qt(e){var r=we();return i.useEffect(()=>{r(it(e))},[r,e]),null}function ea(e){var r=we();return i.useEffect(()=>(r(ue(e)),()=>{r(ue({width:0,height:0}))}),[r,e]),null}function ta(e){var r=Bt(),n=tt(),a=at(),{width:s,height:h,wrapperStyle:d,portal:f}=e,[p,v]=rt([r]),x=nt(),g=st();if(x==null||g==null)return null;var P=x-(a.left||0)-(a.right||0),w=K.getWidthOrHeight(e.layout,h,s,P),u=f?d:V(V({position:"absolute",width:(w==null?void 0:w.width)||s||"auto",height:(w==null?void 0:w.height)||h||"auto"},Jt(d,e,a,x,g,p)),d),o=f??n;if(o==null)return null;var c=i.createElement("div",{className:"recharts-legend-wrapper",style:u,ref:v},i.createElement(Qt,{layout:e.layout,align:e.align,verticalAlign:e.verticalAlign,itemSorter:e.itemSorter}),i.createElement(ea,{width:p.width,height:p.height}),i.createElement(Yt,Q({},e,w,{margin:a,chartWidth:x,chartHeight:g,contextPayload:r})));return Ke.createPortal(c,o)}class K extends i.PureComponent{static getWidthOrHeight(r,n,a,s){return r==="vertical"&&et(n)?{height:n}:r==="horizontal"?{width:a||s}:null}render(){return i.createElement(ta,this.props)}}oe(K,"displayName","Legend");oe(K,"defaultProps",{align:"center",iconSize:14,itemSorter:"value",layout:"horizontal",verticalAlign:"bottom"});var Te=(e,r,n,a)=>Pe(e,"xAxis",r,a),ze=(e,r,n,a)=>Ae(e,"xAxis",r,a),Fe=(e,r,n,a)=>Pe(e,"yAxis",n,a),We=(e,r,n,a)=>Ae(e,"yAxis",n,a),aa=ae([Se,Te,Fe,ze,We],(e,r,n,a,s)=>dt(e,"xAxis")?he(r,a,!1):he(n,s,!1)),ra=(e,r,n,a,s)=>s;function na(e){return e.type==="line"}var sa=ae([ct,ra],(e,r)=>e.filter(na).find(n=>n.id===r)),ia=ae([Se,Te,Fe,ze,We,sa,aa,ot],(e,r,n,a,s,h,d,f)=>{var{chartData:p,dataStartIndex:v,dataEndIndex:x}=f;if(!(h==null||r==null||n==null||a==null||s==null||a.length===0||s.length===0||d==null)){var{dataKey:g,data:P}=h,w;if(P!=null&&P.length>0?w=P:w=p==null?void 0:p.slice(v,x+1),w!=null)return Ea({layout:e,xAxis:r,yAxis:n,xAxisTicks:a,yAxisTicks:s,dataKey:g,bandSize:d,displayedData:w})}}),la=["id"],oa=["type","layout","connectNulls","needClip"],ca=["activeDot","animateNewValues","animationBegin","animationDuration","animationEasing","connectNulls","dot","hide","isAnimationActive","label","legendType","xAxisId","yAxisId","id"];function ye(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),n.push.apply(n,a)}return n}function I(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?ye(Object(n),!0).forEach(function(a){da(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ye(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function da(e,r,n){return(r=ua(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function ua(e){var r=ha(e,"string");return typeof r=="symbol"?r:r+""}function ha(e,r){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,r);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function ce(e,r){if(e==null)return{};var n,a,s=ma(e,r);if(Object.getOwnPropertySymbols){var h=Object.getOwnPropertySymbols(e);for(a=0;a<h.length;a++)n=h[a],r.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(s[n]=e[n])}return s}function ma(e,r){if(e==null)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)!==-1)continue;n[a]=e[a]}return n}function M(){return M=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},M.apply(null,arguments)}var fa=e=>{var{dataKey:r,name:n,stroke:a,legendType:s,hide:h}=e;return[{inactive:h,dataKey:r,type:s,color:a,value:De(n,r),payload:e}]};function pa(e){var{dataKey:r,data:n,stroke:a,strokeWidth:s,fill:h,name:d,hide:f,unit:p}=e;return{dataDefinedOnItem:n,positions:void 0,settings:{stroke:a,strokeWidth:s,fill:h,dataKey:r,nameKey:void 0,name:De(d,r),hide:f,type:e.tooltipType,color:e.stroke,unit:p}}}var Re=(e,r)=>"".concat(r,"px ").concat(e-r,"px");function xa(e,r){for(var n=e.length%2!==0?[...e,0]:e,a=[],s=0;s<r;++s)a=[...a,...n];return a}var va=(e,r,n)=>{var a=n.reduce((g,P)=>g+P);if(!a)return Re(r,e);for(var s=Math.floor(e/a),h=e%a,d=r-e,f=[],p=0,v=0;p<n.length;v+=n[p],++p)if(v+n[p]>h){f=[...n.slice(0,p),h-v];break}var x=f.length%2===0?[0,d]:[d];return[...xa(n,s),...f,...x].map(g=>"".concat(g,"px")).join(", ")};function ga(e,r){var n;if(i.isValidElement(e))n=i.cloneElement(e,r);else if(typeof e=="function")n=e(r);else{var a=te("recharts-line-dot",typeof e!="boolean"?e.className:"");n=i.createElement(Et,M({},r,{className:a}))}return n}function ya(e,r){return e==null?!1:r?!0:e.length===1}function ja(e){var{clipPathId:r,points:n,props:a}=e,{dot:s,dataKey:h,needClip:d}=a;if(!ya(n,s))return null;var{id:f}=a,p=ce(a,la),v=Ce(s),x=kt(p),g=re(s,!0),P=n.map((u,o)=>{var c=I(I(I({key:"dot-".concat(o),r:3},x),g),{},{index:o,cx:u.x,cy:u.y,dataKey:h,value:u.value,payload:u.payload,points:n});return ga(s,c)}),w={clipPath:d?"url(#clipPath-".concat(v?"":"dots-").concat(r,")"):void 0};return i.createElement(Le,M({className:"recharts-line-dots",key:"dots"},w),P)}function ba(e){var{showLabels:r,children:n,points:a}=e,s=i.useMemo(()=>a==null?void 0:a.map(h=>{var d={x:h.x,y:h.y,width:0,height:0};return I(I({},d),{},{value:h.value,payload:h.payload,viewBox:d,parentViewBox:void 0,fill:void 0})}),[a]);return i.createElement(Pt,{value:r?s:null},n)}function je(e){var{clipPathId:r,pathRef:n,points:a,strokeDasharray:s,props:h}=e,{type:d,layout:f,connectNulls:p,needClip:v}=h,x=ce(h,oa),g=I(I({},re(x,!0)),{},{fill:"none",className:"recharts-line-curve",clipPath:v?"url(#clipPath-".concat(r,")"):void 0,points:a,type:d,layout:f,connectNulls:p,strokeDasharray:s??h.strokeDasharray});return i.createElement(i.Fragment,null,(a==null?void 0:a.length)>1&&i.createElement(At,M({},g,{pathRef:n})),i.createElement(ja,{points:a,clipPathId:r,props:h}))}function Na(e){try{return e&&e.getTotalLength&&e.getTotalLength()||0}catch{return 0}}function wa(e){var{clipPathId:r,props:n,pathRef:a,previousPointsRef:s,longestAnimatedLengthRef:h}=e,{points:d,strokeDasharray:f,isAnimationActive:p,animationBegin:v,animationDuration:x,animationEasing:g,animateNewValues:P,width:w,height:u,onAnimationEnd:o,onAnimationStart:c}=n,j=s.current,S=Nt(n,"recharts-line-"),[m,y]=i.useState(!1),E=!m,D=i.useCallback(()=>{typeof o=="function"&&o(),y(!1)},[o]),C=i.useCallback(()=>{typeof c=="function"&&c(),y(!0)},[c]),T=Na(a.current),F=h.current;return i.createElement(ba,{points:d,showLabels:E},n.children,i.createElement(wt,{animationId:S,begin:v,duration:x,isActive:p,easing:g,onAnimationEnd:D,onAnimationStart:C,key:S},_=>{var G=H(F,T+F,_),B=Math.min(G,T),W;if(p)if(f){var X="".concat(f).split(/[,\s]+/gim).map(L=>parseFloat(L));W=va(B,T,X)}else W=Re(T,B);else W=f==null?void 0:String(f);if(j){var Z=j.length/d.length,U=_===1?d:d.map((L,Y)=>{var z=Math.floor(Y*Z);if(j[z]){var l=j[z];return I(I({},L),{},{x:H(l.x,L.x,_),y:H(l.y,L.y,_)})}return P?I(I({},L),{},{x:H(w*2,L.x,_),y:H(u/2,L.y,_)}):I(I({},L),{},{x:L.x,y:L.y})});return s.current=U,i.createElement(je,{props:n,points:U,clipPathId:r,pathRef:a,strokeDasharray:W})}return _>0&&T>0&&(s.current=d,h.current=B),i.createElement(je,{props:n,points:d,clipPathId:r,pathRef:a,strokeDasharray:W})}),i.createElement(St,{label:n.label}))}function Sa(e){var{clipPathId:r,props:n}=e,a=i.useRef(null),s=i.useRef(0),h=i.useRef(null);return i.createElement(wa,{props:n,clipPathId:r,previousPointsRef:a,longestAnimatedLengthRef:s,pathRef:h})}var Pa=(e,r)=>({x:e.x,y:e.y,value:e.value,errorVal:Oe(e.payload,r)});class Aa extends i.Component{render(){var r,{hide:n,dot:a,points:s,className:h,xAxisId:d,yAxisId:f,top:p,left:v,width:x,height:g,id:P,needClip:w}=this.props;if(n)return null;var u=te("recharts-line",h),o=P,{r:c=3,strokeWidth:j=2}=(r=re(a,!1))!==null&&r!==void 0?r:{r:3,strokeWidth:2},S=Ce(a),m=c*2+j;return i.createElement(i.Fragment,null,i.createElement(Le,{className:u},w&&i.createElement("defs",null,i.createElement(yt,{clipPathId:o,xAxisId:d,yAxisId:f}),!S&&i.createElement("clipPath",{id:"clipPath-dots-".concat(o)},i.createElement("rect",{x:v-m/2,y:p-m/2,width:x+m,height:g+m}))),i.createElement(jt,{xAxisId:d,yAxisId:f,data:s,dataPointFormatter:Pa,errorBarOffset:0},i.createElement(Sa,{props:this.props,clipPathId:o}))),i.createElement(bt,{activeDot:this.props.activeDot,points:s,mainColor:this.props.stroke,itemDataKey:this.props.dataKey}))}}var Me={activeDot:!0,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",connectNulls:!1,dot:!0,fill:"#fff",hide:!1,isAnimationActive:!pt.isSsr,label:!1,legendType:"line",stroke:"#3182bd",strokeWidth:1,xAxisId:0,yAxisId:0};function ka(e){var r=ke(e,Me),{activeDot:n,animateNewValues:a,animationBegin:s,animationDuration:h,animationEasing:d,connectNulls:f,dot:p,hide:v,isAnimationActive:x,label:g,legendType:P,xAxisId:w,yAxisId:u,id:o}=r,c=ce(r,ca),{needClip:j}=xt(w,u),S=vt(),m=gt(),y=Ee(),E=Ne(_=>ia(_,w,u,y,o));if(m!=="horizontal"&&m!=="vertical"||E==null||S==null)return null;var{height:D,width:C,x:T,y:F}=S;return i.createElement(Aa,M({},c,{id:o,connectNulls:f,dot:p,activeDot:n,animateNewValues:a,animationBegin:s,animationDuration:h,animationEasing:d,isAnimationActive:x,hide:v,label:g,legendType:P,xAxisId:w,yAxisId:u,points:E,layout:m,height:D,width:C,left:T,top:F,needClip:j}))}function Ea(e){var{layout:r,xAxis:n,yAxis:a,xAxisTicks:s,yAxisTicks:h,dataKey:d,bandSize:f,displayedData:p}=e;return p.map((v,x)=>{var g=Oe(v,d);if(r==="horizontal"){var P=me({axis:n,ticks:s,bandSize:f,entry:v,index:x}),w=fe(g)?null:a.scale(g);return{x:P,y:w,value:g,payload:v}}var u=fe(g)?null:n.scale(g),o=me({axis:a,ticks:h,bandSize:f,entry:v,index:x});return u==null||o==null?null:{x:u,y:o,value:g,payload:v}}).filter(Boolean)}function Da(e){var r=ke(e,Me),n=Ee();return i.createElement(ut,{id:r.id,type:"line"},a=>i.createElement(i.Fragment,null,i.createElement(ht,{legendPayload:fa(r)}),i.createElement(mt,{fn:pa,args:r}),i.createElement(ft,{type:"line",id:a,data:r.data,xAxisId:r.xAxisId,yAxisId:r.yAxisId,zAxisId:0,dataKey:r.dataKey,hide:r.hide,isPanorama:n}),i.createElement(ka,M({},r,{id:a}))))}var ee=i.memo(Da);ee.displayName="Line";var Ca=["axis"],La=i.forwardRef((e,r)=>i.createElement(Dt,{chartName:"LineChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:Ca,tooltipPayloadSearcher:Ct,categoricalChartProps:e,ref:r}));function Ma({widget:e,dashboardId:r,isEditing:n}){const[a,s]=i.useState(null),[h,d]=i.useState(!0),[f,p]=i.useState(null),{formatAmount:v}=Be();i.useEffect(()=>{!n&&r&&e.id?x():(s({value:0,previousValue:0,change:0,trend:"neutral"}),d(!1))},[e,r,n]);const x=async()=>{var u;try{d(!0);const o=await fetch(`/api/dashboards/${r}/widgets/${e.id}/data`,{headers:{"X-CSRF-TOKEN":(u=document.querySelector('meta[name="csrf-token"]'))==null?void 0:u.getAttribute("content"),Accept:"application/json","Content-Type":"application/json"},credentials:"same-origin"});if(!o.ok)throw new Error(`Failed to fetch widget data: ${o.status} ${o.statusText}`);const c=await o.json();if(c.success)s(c.data);else throw new Error(c.message||"Failed to load widget data")}catch(o){console.error("Widget data fetch error:",o),p(o.message)}finally{d(!1)}},g=u=>{var S;const o=e.configuration.format||((S=e.configuration.chart_options)==null?void 0:S.format),c=e.configuration.precision||2;if(u==null||isNaN(u))return"N/A";let j=u;switch(o){case"currency":j=v(u);break;case"percentage":j=`${(u*100).toFixed(c)}%`;break;case"number":default:typeof u=="number"?j=u.toLocaleString("en-US",{minimumFractionDigits:c,maximumFractionDigits:c}):j=u.toString()}return j},P=u=>{switch(u){case"up":return t.jsx(He,{size:20,className:"text-success"});case"down":return t.jsx(Ue,{size:20,className:"text-danger"});default:return t.jsx(Wt,{size:20,className:"text-muted"})}},w=u=>u>0?"text-success":u<0?"text-danger":"text-muted";return h?t.jsx("div",{className:"card h-100",children:t.jsx("div",{className:"card-body d-flex align-items-center justify-content-center",children:t.jsx("div",{className:"spinner-border text-primary",role:"status",children:t.jsx("span",{className:"visually-hidden",children:"Loading..."})})})}):f?t.jsx("div",{className:"card h-100",children:t.jsx("div",{className:"card-body d-flex align-items-center justify-content-center",children:t.jsxs("div",{className:"text-center text-muted",children:[t.jsx("div",{className:"mb-2",children:t.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"icon icon-lg",width:"48",height:"48",viewBox:"0 0 24 24",strokeWidth:"1",stroke:"currentColor",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",children:[t.jsx("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),t.jsx("circle",{cx:"12",cy:"12",r:"9"}),t.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),t.jsx("line",{x1:"12",y1:"16",x2:"12.01",y2:"16"})]})}),t.jsx("div",{children:"Error loading data"}),t.jsx("small",{children:f})]})})}):t.jsx("div",{className:"card h-100",children:t.jsxs("div",{className:"card-body",children:[t.jsxs("div",{className:"d-flex align-items-center justify-content-between mb-2",children:[t.jsx("h3",{className:"card-title mb-0",children:e.title}),(a==null?void 0:a.trend)&&P(a.trend)]}),t.jsxs("div",{className:"d-flex align-items-baseline",children:[t.jsx("div",{className:"h1 mb-0 me-2",children:g(a==null?void 0:a.value)}),(a==null?void 0:a.change)!==void 0&&t.jsxs("div",{className:`${w(a.change)} fw-bold`,children:[a.change>0?"+":"",a.change.toFixed(2),"%"]})]}),(a==null?void 0:a.previousValue)!==void 0&&t.jsxs("div",{className:"text-muted small mt-1",children:["Previous: ",g(a.previousValue)]}),n&&t.jsx("div",{className:"mt-2",children:t.jsx("span",{className:"badge bg-secondary-lt",children:"No Data Available"})})]})})}function Va({widget:e,dashboardId:r,isEditing:n}){const[a,s]=i.useState([]),[h,d]=i.useState(!0),[f,p]=i.useState(null),[v,x]=i.useState(""),[g,P]=i.useState(""),[w,u]=i.useState("asc"),[o,c]=i.useState(1),{pageSize:j=15,sortable:S=!0,searchable:m=!0}=e.configuration.chart_options||{};i.useEffect(()=>{!n&&r&&e.id?y():(s([]),d(!1))},[e,r,n]);const y=async()=>{try{d(!0);const l=await fetch(`/api/dashboards/${r}/widgets/${e.id}/data`);if(!l.ok)throw new Error("Failed to fetch widget data");const b=await l.json();if(b.success&&b.data){const N=b.data.data||b.data||[],k=Array.isArray(N)?N:[];s(k)}else s([])}catch(l){console.error("Widget data fetch error:",l),p(l.message),s([])}finally{d(!1)}},E=l=>{S&&(g===l?u(w==="asc"?"desc":"asc"):(P(l),u("asc")))},D=()=>{if(!Array.isArray(a)||a.length===0)return[];let l=a;return v&&m&&(l=a.filter(b=>Object.values(b).some(N=>N==null?void 0:N.toString().toLowerCase().includes(v.toLowerCase())))),g&&S&&(l=[...l].sort((b,N)=>{const k=b[g],A=N[g];if(typeof k=="number"&&typeof A=="number")return w==="asc"?k-A:A-k;const O=(k==null?void 0:k.toString())||"",R=(A==null?void 0:A.toString())||"";return w==="asc"?O.localeCompare(R):R.localeCompare(O)})),l},C=()=>{const l=D(),b=(o-1)*j;return l.slice(b,b+j)},T=()=>Math.ceil(D().length/j),F=(l,b)=>typeof l=="number"?new Intl.NumberFormat("en-US").format(l):l,_=(l,b)=>{var N;if(b==="customer_id"&&l){const k=((N=a.find(A=>A[b]===l))==null?void 0:N.customer_name)||"Unknown Customer";return t.jsxs("div",{className:"d-flex align-items-center justify-content-between",children:[t.jsxs("div",{style:{minWidth:0,flex:1},children:[t.jsx("div",{className:"fw-medium text-truncate",title:l,children:l}),t.jsx("small",{className:"text-muted text-truncate d-block",title:k,children:k})]}),t.jsx(de,{href:`/customers/${l}`,className:"ms-1 text-primary flex-shrink-0",title:"View Customer Details",children:t.jsx(xe,{size:12})})]})}if(b==="loan_id"&&l)return t.jsxs("div",{className:"d-flex align-items-center justify-content-between",children:[t.jsx("span",{className:"fw-medium text-truncate",title:l,children:l}),t.jsx(de,{href:`/loans/${l}`,className:"ms-1 text-primary flex-shrink-0",title:"View Loan Details",children:t.jsx(xe,{size:12})})]});if(b.includes("amount")||b.includes("exposure")||b.includes("ecl")||b.includes("balance")){const k=F(l);return t.jsxs("span",{className:"text-end d-block text-truncate",title:"ZMW{formattedValue}",children:["ZMW",k]})}if(b.includes("rate")||b.includes("ratio")||b.includes("default")||b.includes("lgd")||b.includes("pd")){const k=typeof l=="number"?(l*100).toFixed(2)+"%":l;return t.jsx("span",{className:"text-end d-block text-truncate",title:k,children:k})}return b==="customer_name"&&l?t.jsx("span",{className:"text-truncate d-block",title:l,children:l}):t.jsx("span",{className:"text-truncate d-block",title:F(l),children:F(l)})},G=()=>!Array.isArray(a)||a.length===0?[]:Object.keys(a[0]).filter(l=>l!=="id"),B=()=>{const l=D(),b=X(l,L);U(b,`${e.title.replace(/[^a-zA-Z0-9]/g,"_")}.csv`,"text/csv")},W=()=>{const l=D(),b=Z(l,L);U(b,`${e.title.replace(/[^a-zA-Z0-9]/g,"_")}.xlsx`,"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet")},X=(l,b)=>{const N=b.map(A=>A.replace(/_/g," ").toUpperCase()).join(","),k=l.map(A=>b.map(O=>{const R=A[O];return typeof R=="string"&&R.includes(",")?`"${R}"`:R||""}).join(","));return[N,...k].join(`
`)},Z=(l,b)=>{const N=b.map(A=>`<th>${A.replace(/_/g," ").toUpperCase()}</th>`).join(""),k=l.map(A=>`<tr>${b.map(O=>`<td>${A[O]||""}</td>`).join("")}</tr>`).join("");return`
            <html>
                <head>
                    <meta charset="utf-8">
                    <title>${e.title}</title>
                </head>
                <body>
                    <table>
                        <thead><tr>${N}</tr></thead>
                        <tbody>${k}</tbody>
                    </table>
                </body>
            </html>
        `},U=(l,b,N)=>{const k=new Blob([l],{type:N}),A=window.URL.createObjectURL(k),O=document.createElement("a");O.href=A,O.download=b,document.body.appendChild(O),O.click(),document.body.removeChild(O),window.URL.revokeObjectURL(A)};if(h)return t.jsxs("div",{className:"card h-100",children:[t.jsx("div",{className:"card-header",children:t.jsx("h3",{className:"card-title",children:e.title})}),t.jsx("div",{className:"card-body d-flex align-items-center justify-content-center",children:t.jsx("div",{className:"spinner-border text-primary",role:"status",children:t.jsx("span",{className:"visually-hidden",children:"Loading..."})})})]});if(f)return t.jsxs("div",{className:"card h-100",children:[t.jsx("div",{className:"card-header",children:t.jsx("h3",{className:"card-title",children:e.title})}),t.jsx("div",{className:"card-body d-flex align-items-center justify-content-center",children:t.jsxs("div",{className:"text-center text-muted",children:[t.jsx("div",{children:"Error loading data"}),t.jsx("small",{children:f})]})})]});const L=G(),Y=C(),z=T();return t.jsxs("div",{className:"card h-100 shadow-sm",children:[t.jsx("div",{className:"card-header bg-gradient-primary text-white",children:t.jsxs("div",{className:"d-flex align-items-center justify-content-between",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"card-title mb-0 text-white",children:e.title}),t.jsxs("small",{className:"text-white-50",children:[D().length," records"]})]}),t.jsxs("div",{className:"d-flex align-items-center gap-2",children:[t.jsxs("div",{className:"btn-group btn-group-sm",role:"group",children:[t.jsx("button",{type:"button",className:"btn btn-light btn-sm",onClick:B,title:"Export to CSV",children:t.jsx(Ve,{size:16})}),t.jsx("button",{type:"button",className:"btn btn-light btn-sm",onClick:W,title:"Export to Excel",children:t.jsx(zt,{size:16})})]}),m&&t.jsxs("div",{className:"input-group input-group-sm",style:{width:"200px"},children:[t.jsx("span",{className:"input-group-text bg-white",children:t.jsx(qe,{size:16})}),t.jsx("input",{type:"text",className:"form-control",placeholder:"Search...",value:v,onChange:l=>x(l.target.value)})]})]})]})}),t.jsx("div",{className:"card-body p-0",style:{overflow:"hidden",minHeight:"400px",height:"100%"},children:t.jsx("div",{className:"table-responsive h-100",style:{overflow:"auto"},children:t.jsxs("table",{className:"table table-hover mb-0 table-striped",style:{minWidth:"100%",tableLayout:"fixed",width:"100%",fontSize:"0.9rem"},children:[t.jsx("thead",{className:"table-dark sticky-top",style:{zIndex:10},children:t.jsx("tr",{children:L.map((l,b)=>{let N="auto";return l.includes("customer")?N="220px":l.includes("loan_id")?N="140px":l.includes("amount")||l.includes("exposure")||l.includes("ecl")?N="160px":l.includes("probability")||l.includes("loss_given")?N="130px":l.includes("recovery")?N="140px":N="120px",t.jsx("th",{className:`${S?"cursor-pointer user-select-none":""} px-3 py-3`,onClick:()=>E(l),style:{width:N,minWidth:N,maxWidth:N,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",borderRight:"1px solid #495057",padding:"12px 16px",backgroundColor:"#343a40",color:"#ffffff",fontWeight:"600",fontSize:"0.85rem",textTransform:"uppercase",letterSpacing:"0.5px"},title:l.replace(/_/g," "),children:t.jsxs("div",{className:"d-flex align-items-center justify-content-between",children:[t.jsx("span",{className:"text-capitalize fw-medium",style:{fontSize:"0.9rem",overflow:"hidden",textOverflow:"ellipsis"},children:l.replace(/_/g," ")}),S&&g===l&&t.jsx("span",{className:"ms-1 flex-shrink-0",children:w==="asc"?t.jsx(Ge,{size:12}):t.jsx(Xe,{size:12})})]})},l)})})}),t.jsx("tbody",{children:Y.map((l,b)=>t.jsx("tr",{className:"border-bottom",children:L.map((N,k)=>{let A="auto";return N.includes("customer")?A="220px":N.includes("loan_id")?A="140px":N.includes("amount")||N.includes("exposure")||N.includes("ecl")?A="160px":N.includes("probability")||N.includes("loss_given")?A="130px":N.includes("recovery")?A="140px":A="120px",t.jsx("td",{className:"px-3 py-3 align-middle",style:{width:A,minWidth:A,maxWidth:A,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",borderRight:"1px solid #dee2e6",fontSize:"0.9rem",padding:"12px 16px",backgroundColor:"transparent",transition:"background-color 0.2s ease"},onMouseEnter:O=>O.target.style.backgroundColor="#f8f9fa",onMouseLeave:O=>O.target.style.backgroundColor="transparent",children:N==="status"?t.jsx("span",{className:`badge ${l[N]==="Active"?"bg-success":"bg-secondary"}`,children:l[N]}):_(l[N],N)},N)})},l.id||b))})]})})}),z>1&&t.jsx("div",{className:"card-footer bg-light",children:t.jsxs("div",{className:"d-flex align-items-center justify-content-between",children:[t.jsxs("div",{className:"text-muted small fw-medium",children:["Showing ",(o-1)*j+1," to ",Math.min(o*j,D().length)," of ",D().length," entries"]}),t.jsx("nav",{children:t.jsxs("ul",{className:"pagination pagination-sm mb-0",children:[t.jsx("li",{className:`page-item ${o===1?"disabled":""}`,children:t.jsx("button",{className:"page-link border-0",onClick:()=>c(o-1),disabled:o===1,style:{backgroundColor:o===1?"#e9ecef":"#ffffff",color:o===1?"#6c757d":"#007bff"},children:"Previous"})}),Array.from({length:z},(l,b)=>b+1).map(l=>t.jsx("li",{className:`page-item ${o===l?"active":""}`,children:t.jsx("button",{className:"page-link border-0",onClick:()=>c(l),style:{backgroundColor:o===l?"#007bff":"#ffffff",color:o===l?"#ffffff":"#007bff"},children:l})},l)),t.jsx("li",{className:`page-item ${o===z?"disabled":""}`,children:t.jsx("button",{className:"page-link border-0",onClick:()=>c(o+1),disabled:o===z,style:{backgroundColor:o===z?"#e9ecef":"#ffffff",color:o===z?"#6c757d":"#007bff"},children:"Next"})})]})})]})}),n&&t.jsx("div",{className:"position-absolute top-0 end-0 m-2",children:t.jsx("span",{className:"badge bg-secondary-lt",children:"No Data Available"})})]})}function Ka({widget:e,dashboardId:r,isEditing:n}){const[a,s]=i.useState([]),[h,d]=i.useState(!0),[f,p]=i.useState(null),{xAxisLabel:v="",yAxisLabel:x="",showLegend:g=!0,showGrid:P=!0}=e.configuration.chart_options||{};i.useEffect(()=>{!n&&r&&e.id?w():(s([]),d(!1))},[e,r,n]);const w=async()=>{var c,j;try{d(!0);const S=await fetch(`/api/dashboards/${r}/widgets/${e.id}/data`,{headers:{"X-CSRF-TOKEN":(c=document.querySelector('meta[name="csrf-token"]'))==null?void 0:c.getAttribute("content"),Accept:"application/json","Content-Type":"application/json"},credentials:"same-origin"});if(!S.ok)throw new Error(`Failed to fetch widget data: ${S.status} ${S.statusText}`);const m=await S.json();if(m.success){const y=((j=m.data)==null?void 0:j.data)||m.data||[],E=Array.isArray(y)?y:[];s(E)}else throw new Error(m.message||"Failed to load widget data")}catch(S){console.error("Widget data fetch error:",S),p(S.message),s([])}finally{d(!1)}},u=(c,j)=>[new Intl.NumberFormat("en-US").format(c),j],o=c=>{if(typeof c=="number"){if(c>=1e6)return`${(c/1e6).toFixed(1)}M`;if(c>=1e3)return`${(c/1e3).toFixed(1)}K`}return c};return h?t.jsxs("div",{className:"card h-100",children:[t.jsx("div",{className:"card-header",children:t.jsx("h3",{className:"card-title",children:e.configuration.title})}),t.jsx("div",{className:"card-body d-flex align-items-center justify-content-center",children:t.jsx("div",{className:"spinner-border text-primary",role:"status",children:t.jsx("span",{className:"visually-hidden",children:"Loading..."})})})]}):f?t.jsxs("div",{className:"card h-100",children:[t.jsx("div",{className:"card-header",children:t.jsx("h3",{className:"card-title",children:e.configuration.title})}),t.jsx("div",{className:"card-body d-flex align-items-center justify-content-center",children:t.jsxs("div",{className:"text-center text-muted",children:[t.jsx("div",{children:"Error loading data"}),t.jsx("small",{children:f})]})})]}):t.jsxs("div",{className:"card h-100",children:[t.jsx("div",{className:"card-header",children:t.jsxs("div",{className:"d-flex align-items-center justify-content-between",children:[t.jsx("h3",{className:"card-title mb-0",children:e.configuration.title}),n&&t.jsx("span",{className:"badge bg-secondary-lt",children:"No Data Available"})]})}),t.jsx("div",{className:"card-body",style:{padding:"20px",minHeight:"350px"},children:t.jsx(ne,{width:"100%",height:"100%",children:t.jsxs(Lt,{data:a,margin:{top:20,right:30,left:20,bottom:5},children:[P&&t.jsx(Ie,{strokeDasharray:"3 3",stroke:"#e9ecef"}),t.jsx($e,{dataKey:"name",tick:{fontSize:12},label:v?{value:v,position:"insideBottom",offset:-5}:void 0}),t.jsx(_e,{tick:{fontSize:12},tickFormatter:o,label:x?{value:x,angle:-90,position:"insideLeft"}:void 0}),t.jsx(se,{formatter:u,contentStyle:{backgroundColor:"#fff",border:"1px solid #dee2e6",borderRadius:"4px",fontSize:"12px"}}),g&&t.jsx(K,{}),t.jsx(pe,{dataKey:"value",fill:"#3385ff",name:"Actual",radius:[2,2,0,0]}),Array.isArray(a)&&a.length>0&&a.some(c=>c.target!==void 0)&&t.jsx(pe,{dataKey:"target",fill:"#66a3ff",name:"Target",radius:[2,2,0,0]})]})})})]})}const be=["#206bc4","#79a6dc","#a8cc8c","#ffa94d","#fd7e14","#e74c3c","#9b59b6","#1abc9c"];function Ba({widget:e,dashboardId:r,isEditing:n}){const[a,s]=i.useState([]),[h,d]=i.useState(!0),[f,p]=i.useState(null),{showLabels:v=!0,showPercentages:x=!0}=e.configuration.chart_options||{};i.useEffect(()=>{!n&&r&&e.id?g():(s([]),d(!1))},[e,r,n]);const g=async()=>{var u,o;try{d(!0);const c=await fetch(`/api/dashboards/${r}/widgets/${e.id}/data`,{headers:{"X-CSRF-TOKEN":(u=document.querySelector('meta[name="csrf-token"]'))==null?void 0:u.getAttribute("content"),Accept:"application/json","Content-Type":"application/json"},credentials:"same-origin"});if(!c.ok)throw new Error(`Failed to fetch widget data: ${c.status} ${c.statusText}`);const j=await c.json();if(j.success){const m=(((o=j.data)==null?void 0:o.data)||j.data||[]).map(y=>({name:y.name||y.label||"Unknown",value:y.value||0})).filter(y=>y.value>0&&y.name&&y.name.trim()!=="").map(y=>({...y,name:y.name.trim()||"Unspecified"}));s(m)}else throw new Error(j.message||"Failed to load widget data")}catch(c){console.error("Widget data fetch error:",c),p(c.message)}finally{d(!1)}},P=(u,o)=>{if(!Array.isArray(a)||a.length===0)return[u,o];const c=a.reduce((S,m)=>S+(m.value||0),0),j=c>0?(u/c*100).toFixed(1):0;return[`ZMW${new Intl.NumberFormat("en-US").format(u)} (${j}%)`,o]},w=u=>{if(!v||!Array.isArray(a)||a.length===0)return null;const o=a.reduce((j,S)=>j+(S.value||0),0),c=o>0?(u.value/o*100).toFixed(1):0;return x?`${u.name}: ${c}%`:u.name};return h?t.jsxs("div",{className:"card h-100",children:[t.jsx("div",{className:"card-header",children:t.jsx("h3",{className:"card-title",children:e.title})}),t.jsx("div",{className:"card-body d-flex align-items-center justify-content-center",children:t.jsx("div",{className:"spinner-border text-primary",role:"status",children:t.jsx("span",{className:"visually-hidden",children:"Loading..."})})})]}):f?t.jsxs("div",{className:"card h-100",children:[t.jsx("div",{className:"card-header",children:t.jsx("h3",{className:"card-title",children:e.title})}),t.jsx("div",{className:"card-body d-flex align-items-center justify-content-center",children:t.jsxs("div",{className:"text-center text-muted",children:[t.jsx("div",{children:"Error loading data"}),t.jsx("small",{children:f})]})})]}):!a||a.length===0?t.jsxs("div",{className:"card h-100",children:[t.jsx("div",{className:"card-header",children:t.jsx("h3",{className:"card-title",children:e.title})}),t.jsx("div",{className:"card-body d-flex align-items-center justify-content-center",children:t.jsxs("div",{className:"text-center text-muted",children:[t.jsx("div",{children:"No data available"}),t.jsx("small",{children:"This widget will show data when available"})]})})]}):t.jsxs("div",{className:"card h-100",children:[t.jsx("div",{className:"card-header",children:t.jsxs("div",{className:"d-flex align-items-center justify-content-between",children:[t.jsx("h3",{className:"card-title mb-0",children:e.title}),n&&t.jsx("span",{className:"badge bg-secondary-lt",children:"No Data Available"})]})}),t.jsx("div",{className:"card-body",style:{padding:"20px",minHeight:"400px"},children:t.jsx(ne,{width:"100%",height:"100%",children:t.jsxs(Ot,{children:[t.jsx(It,{data:a,cx:"50%",cy:"50%",labelLine:!1,label:v?w:!1,outerRadius:120,innerRadius:20,fill:"#8884d8",dataKey:"value",children:a.map((u,o)=>t.jsx($t,{fill:be[o%be.length]},`cell-${o}`))}),t.jsx(se,{formatter:P,contentStyle:{backgroundColor:"#fff",border:"1px solid #dee2e6",borderRadius:"4px",fontSize:"12px"}}),t.jsx(K,{verticalAlign:"bottom",height:60,iconType:"circle",formatter:(u,o)=>{if(!Array.isArray(a)||a.length===0)return u;const c=a.reduce((S,m)=>S+(m.value||0),0),j=c>0?(o.value/c*100).toFixed(1):0;return`${u} (${j}%)`},wrapperStyle:{paddingTop:"20px",fontSize:"14px",fontWeight:"500"}})]})})})]})}function Ua({widget:e,dashboardId:r,isEditing:n}){const[a,s]=i.useState([]),[h,d]=i.useState(!0),[f,p]=i.useState(null),{xAxisLabel:v="",yAxisLabel:x="",showLegend:g=!0,showGrid:P=!0}=e.configuration.chart_options||{};i.useEffect(()=>{!n&&r&&e.id?w():(s([]),d(!1))},[e,r,n]);const w=async()=>{var c,j;try{d(!0);const S=await fetch(`/api/dashboards/${r}/widgets/${e.id}/data`,{headers:{"X-CSRF-TOKEN":(c=document.querySelector('meta[name="csrf-token"]'))==null?void 0:c.getAttribute("content"),Accept:"application/json","Content-Type":"application/json"},credentials:"same-origin"});if(!S.ok)throw new Error(`Failed to fetch widget data: ${S.status} ${S.statusText}`);const m=await S.json();if(m.success){const y=((j=m.data)==null?void 0:j.data)||m.data||[],D=(Array.isArray(y)?y:[]).map(C=>({name:C.name||C.label||C.date||"Unknown",value:C.value||0,previous:C.previous||C.previous_value||void 0})).filter(C=>C.value!==null&&C.value!==void 0&&!isNaN(C.value));s(D)}else throw new Error(m.message||"Failed to load widget data")}catch(S){console.error("Widget data fetch error:",S),p(S.message),s([])}finally{d(!1)}},u=(c,j)=>[new Intl.NumberFormat("en-US").format(c),j],o=c=>{if(typeof c=="number"){if(c>=1e6)return`${(c/1e6).toFixed(1)}M`;if(c>=1e3)return`${(c/1e3).toFixed(1)}K`}return c};return h?t.jsxs("div",{className:"card h-100",children:[t.jsx("div",{className:"card-header",children:t.jsx("h3",{className:"card-title",children:e.title})}),t.jsx("div",{className:"card-body d-flex align-items-center justify-content-center",children:t.jsx("div",{className:"spinner-border text-primary",role:"status",children:t.jsx("span",{className:"visually-hidden",children:"Loading..."})})})]}):f?t.jsxs("div",{className:"card h-100",children:[t.jsx("div",{className:"card-header",children:t.jsx("h3",{className:"card-title",children:e.title})}),t.jsx("div",{className:"card-body d-flex align-items-center justify-content-center",children:t.jsxs("div",{className:"text-center text-muted",children:[t.jsx("div",{children:"Error loading data"}),t.jsx("small",{children:f})]})})]}):!a||a.length===0?t.jsxs("div",{className:"card h-100",children:[t.jsx("div",{className:"card-header",children:t.jsx("h3",{className:"card-title",children:e.title})}),t.jsx("div",{className:"card-body d-flex align-items-center justify-content-center",children:t.jsxs("div",{className:"text-center text-muted",children:[t.jsx("div",{children:"No data available"}),t.jsx("small",{children:"This widget will show data when available"})]})})]}):t.jsxs("div",{className:"card h-100",children:[t.jsx("div",{className:"card-header",children:t.jsxs("div",{className:"d-flex align-items-center justify-content-between",children:[t.jsx("h3",{className:"card-title mb-0",children:e.title}),n&&t.jsx("span",{className:"badge bg-secondary-lt",children:"No Data Available"})]})}),t.jsx("div",{className:"card-body",style:{padding:"20px",minHeight:"350px"},children:t.jsx(ne,{width:"100%",height:"100%",children:t.jsxs(La,{data:a,margin:{top:20,right:30,left:20,bottom:5},children:[P&&t.jsx(Ie,{strokeDasharray:"3 3",stroke:"#e9ecef"}),t.jsx($e,{dataKey:"name",tick:{fontSize:12},label:v?{value:v,position:"insideBottom",offset:-5}:void 0}),t.jsx(_e,{tick:{fontSize:12},tickFormatter:o,label:x?{value:x,angle:-90,position:"insideLeft"}:void 0}),t.jsx(se,{formatter:u,contentStyle:{backgroundColor:"#fff",border:"1px solid #dee2e6",borderRadius:"4px",fontSize:"12px"}}),g&&t.jsx(K,{}),t.jsx(ee,{type:"monotone",dataKey:"value",stroke:"#3385ff",strokeWidth:2,dot:{fill:"#3385ff",strokeWidth:2,r:4},activeDot:{r:6,stroke:"#3385ff",strokeWidth:2},name:"Current"}),Array.isArray(a)&&a.length>0&&a.some(c=>c.previous!==void 0)&&t.jsx(ee,{type:"monotone",dataKey:"previous",stroke:"#66a3ff",strokeWidth:2,strokeDasharray:"5 5",dot:{fill:"#66a3ff",strokeWidth:2,r:4},name:"Previous"})]})})})]})}function Ha({widget:e,dashboardId:r,isEditing:n}){const[a,s]=i.useState([]),[h,d]=i.useState(!0),[f,p]=i.useState(null);i.useEffect(()=>{!n&&r&&e.id?v():(s([]),d(!1))},[e,r,n]);const v=async()=>{try{d(!0);const m=await fetch(`/api/dashboards/${r}/widgets/${e.id}/data`);if(!m.ok)throw new Error("Failed to fetch widget data");const y=await m.json();if(y.success&&y.data){const E=y.data.data||y.data||[];s(Array.isArray(E)?E:[])}else s([])}catch(m){console.error("Widget data fetch error:",m),p(m.message),s([])}finally{d(!1)}},x=m=>!Array.isArray(a)||a.length===0?[]:[...new Set(a.map(y=>y[m]))],g=(m,y)=>{if(!Array.isArray(a)||a.length===0)return 0;const E=a.find(D=>D.x===m&&D.y===y);return E?E.value:0},P=()=>{if(!Array.isArray(a)||a.length===0)return{min:0,max:0};const m=a.map(y=>y.value).filter(y=>typeof y=="number"&&!isNaN(y));return m.length===0?{min:0,max:0}:{min:Math.min(...m),max:Math.max(...m)}},w=m=>{const{min:y,max:E}=P();if(E===y)return .5;const D=(m-y)/(E-y);return Math.max(.1,Math.min(1,D))},u=m=>m>=1e6?`${(m/1e6).toFixed(1)}M`:m>=1e3?`${(m/1e3).toFixed(1)}K`:new Intl.NumberFormat("en-US").format(m);if(h)return t.jsxs("div",{className:"card h-100",children:[t.jsx("div",{className:"card-header",children:t.jsx("h3",{className:"card-title",children:e.title})}),t.jsx("div",{className:"card-body d-flex align-items-center justify-content-center",children:t.jsx("div",{className:"spinner-border text-primary",role:"status",children:t.jsx("span",{className:"visually-hidden",children:"Loading..."})})})]});if(f)return t.jsxs("div",{className:"card h-100",children:[t.jsx("div",{className:"card-header",children:t.jsx("h3",{className:"card-title",children:e.title})}),t.jsx("div",{className:"card-body d-flex align-items-center justify-content-center",children:t.jsxs("div",{className:"text-center text-muted",children:[t.jsx("div",{children:"Error loading data"}),t.jsx("small",{children:f})]})})]});const o=x("x"),c=x("y"),{min:j,max:S}=P();return!Array.isArray(a)||a.length===0?t.jsxs("div",{className:"card h-100",children:[t.jsx("div",{className:"card-header",children:t.jsx("h3",{className:"card-title",children:e.title})}),t.jsx("div",{className:"card-body d-flex align-items-center justify-content-center",children:t.jsxs("div",{className:"text-center text-muted",children:[t.jsx("div",{children:"No data available"}),t.jsx("small",{children:"This widget requires data to display the heatmap"})]})})]}):t.jsxs("div",{className:"card h-100",children:[t.jsx("div",{className:"card-header",children:t.jsxs("div",{className:"d-flex align-items-center justify-content-between",children:[t.jsx("h3",{className:"card-title mb-0",children:e.title}),n&&t.jsx("span",{className:"badge bg-secondary-lt",children:"No Data Available"})]})}),t.jsxs("div",{className:"card-body",children:[t.jsx("div",{className:"heatmap-container",style:{height:"100%",overflow:"auto"},children:t.jsxs("table",{className:"table table-sm mb-0",children:[t.jsx("thead",{children:t.jsxs("tr",{children:[t.jsx("th",{}),o.map(m=>t.jsx("th",{className:"text-center",children:m},m))]})}),t.jsx("tbody",{children:c.map(m=>t.jsxs("tr",{children:[t.jsx("td",{className:"fw-bold",children:m}),o.map(y=>{const E=g(y,m),D=w(E);return t.jsx("td",{className:"text-center position-relative",style:{backgroundColor:`rgba(32, 107, 196, ${D})`,color:D>.5?"white":"black",minWidth:"80px",height:"40px",verticalAlign:"middle"},title:`${m} - ${y}: ${u(E)}`,children:t.jsx("div",{className:"fw-bold",children:u(E)})},`${y}-${m}`)})]},m))})]})}),t.jsxs("div",{className:"mt-3 d-flex align-items-center justify-content-center",children:[t.jsxs("div",{className:"d-flex align-items-center",children:[t.jsx("span",{className:"small text-muted me-2",children:"Low"}),t.jsx("div",{className:"d-flex",children:Array.from({length:5},(m,y)=>t.jsx("div",{style:{width:"20px",height:"10px",backgroundColor:`rgba(32, 107, 196, ${.2+y*.2})`,marginRight:"1px"}},y))}),t.jsx("span",{className:"small text-muted ms-2",children:"High"})]}),t.jsxs("div",{className:"ms-4 small text-muted",children:["Range: ",u(j)," - ",u(S)]})]})]})]})}export{Ka as B,Ha as H,Ra as I,Ma as K,Ua as L,Ba as P,Va as T};
